<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RSS Parser 2.0: bye bye Async Task, welcome Coroutines | Marco Gomiero</title><meta name=keywords content><meta name=description content="Finally, I found some time to sit down and work on my library RSS Parser. Before starting to describe all the cool stuff that I’ve introduced with this update, I want to thank you all for the support. In fact this year, the library exceeded 100 stars on Github, that seems a little goal but it means a lot to me.
I wrote this library back in 2016 and now in 2018, the code was “ugly” compared to all the coolest stuff provided by Kotlin."><meta name=author content="Marco Gomiero"><link rel=canonical href=https://www.marcogomiero.com/posts/2018/bye-async-task/><link crossorigin=anonymous href=/assets/css/stylesheet.min.686715e54e31dbf63447efd76235e41e047fd8826df608657b7b0ddb3a0d900d.css integrity="sha256-aGcV5U4x2/Y0R+/XYjXkHgR/2IJt9ghle3sN2zoNkA0=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.marcogomiero.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.marcogomiero.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.marcogomiero.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.marcogomiero.com/apple-touch-icon.png><link rel=mask-icon href=https://www.marcogomiero.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-69FZ1TLE7E"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-69FZ1TLE7E",{anonymize_ip:!1})}</script><meta property="og:title" content="RSS Parser 2.0: bye bye Async Task, welcome Coroutines"><meta property="og:description" content="Finally, I found some time to sit down and work on my library RSS Parser. Before starting to describe all the cool stuff that I’ve introduced with this update, I want to thank you all for the support. In fact this year, the library exceeded 100 stars on Github, that seems a little goal but it means a lot to me.
I wrote this library back in 2016 and now in 2018, the code was “ugly” compared to all the coolest stuff provided by Kotlin."><meta property="og:type" content="article"><meta property="og:url" content="https://www.marcogomiero.com/posts/2018/bye-async-task/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-12-22T00:00:00+00:00"><meta property="article:modified_time" content="2018-12-22T00:00:00+00:00"><meta property="og:site_name" content="Marco Gomiero"><meta name=twitter:card content="summary"><meta name=twitter:title content="RSS Parser 2.0: bye bye Async Task, welcome Coroutines"><meta name=twitter:description content="Finally, I found some time to sit down and work on my library RSS Parser. Before starting to describe all the cool stuff that I’ve introduced with this update, I want to thank you all for the support. In fact this year, the library exceeded 100 stars on Github, that seems a little goal but it means a lot to me.
I wrote this library back in 2016 and now in 2018, the code was “ugly” compared to all the coolest stuff provided by Kotlin."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.marcogomiero.com/posts/"},{"@type":"ListItem","position":3,"name":"RSS Parser 2.0: bye bye Async Task, welcome Coroutines","item":"https://www.marcogomiero.com/posts/2018/bye-async-task/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"RSS Parser 2.0: bye bye Async Task, welcome Coroutines","name":"RSS Parser 2.0: bye bye Async Task, welcome Coroutines","description":"Finally, I found some time to sit down and work on my library RSS Parser. Before starting to describe all the cool stuff that I’ve introduced with this update, I want to thank you all for the support. In fact this year, the library exceeded 100 stars on Github, that seems a little goal but it means a lot to me.\nI wrote this library back in 2016 and now in 2018, the code was “ugly” compared to all the coolest stuff provided by Kotlin.","keywords":[],"articleBody":"Finally, I found some time to sit down and work on my library RSS Parser. Before starting to describe all the cool stuff that I’ve introduced with this update, I want to thank you all for the support. In fact this year, the library exceeded 100 stars on Github, that seems a little goal but it means a lot to me.\nI wrote this library back in 2016 and now in 2018, the code was “ugly” compared to all the coolest stuff provided by Kotlin.\nSo I decided to rewrite the library using Kotlin and Coroutines, so I can (finally) get rid of Async Task.\nOf course, I maintained the compatibility of the library for the projects that still use Java.\nShortly, the library allows to parse an RSS feed and retrieve some information like title, content, author, etc. You can found more information about the features of the library in the blog post that I’ve published some time ago or in the README available on Github.\nBut now let’s see some code. In this article, I’ll show only how to use the library because I’m planning to publish another blog post with all the technical details and decisions that I have made during the development of this new version.\nThe usage is very simple both if you are using Java or Kotlin. If you are using Kotlin, you need to create a Parser object and then call the suspend method getArticles passing the URL of the RSS feed as parameter. Since this is a suspend function, you need to “launch” the coroutine. Of course, you need also to handle the error case.\nHere is an example:\nimport com.prof.rssparser.Article import com.prof.rssparser.Parser //url of RSS feed private val url = \"[https://www.androidauthority.com/feed](https://www.androidauthority.com/feed)\" coroutineScope.launch(Dispatchers.Main) { try { val parser = Parser() val articleList = parser.getArticles(url) // The list contains all article's data. For example you can use it for your adapter. } catch (e: Exception) { // Handle the exception } } A complete example with Kotlin is available on Github.\nIf you don’t know anything about the coroutines, I suggest you give a look to the Codelab provided by Google.\nInstead, if you are still using Java in your Android project, the usage is pretty the same as the older version of the library. You need to create a Parser object, implements the callbacks that handle the result and the error and finally start the parsing by calling the execute method passing the URL as parameter.\nHere is an example:\nimport com.prof.rssparser.Article; import com.prof.rssparser.OnTaskCompleted; import com.prof.rssparser.Parser; Parser parser = new Parser(); parser.onFinish(new OnTaskCompleted() { //what to do when the parsing is done @Override public void onTaskCompleted(List\u003cArticle\u003e list) { // The list contains all article's data. For example you can use it for your adapter. } //what to do in case of error @Override public void onError(Exception e) { // Handle the exception } }); parser.execute(urlString); A complete example in Java is also available on Github.\nThat’s all! For all the details or to report a bug, please visit the repo on Github.\n","wordCount":"510","inLanguage":"en","datePublished":"2018-12-22T00:00:00Z","dateModified":"2018-12-22T00:00:00Z","author":{"@type":"Person","name":"Marco Gomiero"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.marcogomiero.com/posts/2018/bye-async-task/"},"publisher":{"@type":"Organization","name":"Marco Gomiero","logo":{"@type":"ImageObject","url":"https://www.marcogomiero.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.marcogomiero.com accesskey=h title="Marco Gomiero (Alt + H)">Marco Gomiero</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://www.marcogomiero.com/posts/ title=Write><span>Write</span></a></li><li><a href=https://www.marcogomiero.com/talks/ title=Speak><span>Speak</span></a></li><li><a href=https://www.marcogomiero.com/projects/ title=Build><span>Build</span></a></li><li><a href=https://www.marcogomiero.com/about-me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>RSS Parser 2.0: bye bye Async Task, welcome Coroutines</h1><div class=post-meta style=margin-top:16px><span title='2018-12-22 00:00:00 +0000 UTC'>22 December 2018</span>&nbsp;·&nbsp;3 min</div></header><div class=post-content><p>Finally, I found some time to sit down and work on my library RSS Parser. Before starting to describe all the cool stuff that I’ve introduced with this update, I want to thank you all for the support. In fact this year, the library exceeded 100 stars on Github, that seems a little goal but it means a lot to me.</p><p>I wrote this library back in 2016 and now in 2018, the code was “ugly” compared to all the coolest stuff provided by Kotlin.</p><figure><img loading=lazy src=/img/meme.jpeg alt=image></figure><p>So I decided to rewrite the library using <strong>Kotlin</strong> and <strong>Coroutines</strong>, so I can (finally) get rid of <strong>Async Task</strong>.</p><figure><img loading=lazy src=/img/trump.jpeg alt=image></figure><p>Of course, I maintained the compatibility of the library for the projects that still use Java.</p><p>Shortly, the library allows to parse an RSS feed and retrieve some information like title, content, author, etc. You can found more information about the features of the library in the <a href=http://www.marcogomiero.com/posts/rss-parser-library/>blog post</a> that I’ve published some time ago or in the <a href=https://github.com/prof18/RSS-Parser>README</a> available on Github.</p><p>But now let’s see some code. In this article, I’ll show only how to use the library because I’m planning to publish another blog post with all the technical details and decisions that I have made during the development of this new version.</p><p>The usage is very simple both if you are using Java or Kotlin.
If you are using <strong>Kotlin</strong>, you need to create a <em>Parser</em> object and then call the suspend method <em>getArticles</em> passing the <em>URL</em> of the RSS feed as parameter. Since this is a <em>suspend</em> function, you need to “<a href=https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/launch.html><em>launch</em></a>” the coroutine. Of course, you need also to handle the error case.</p><p>Here is an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> com.prof.rssparser.Article
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.prof.rssparser.Parser
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//url of RSS feed
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>private</span> val url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;[https://www.androidauthority.com/feed](https://www.androidauthority.com/feed)&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>coroutineScope<span style=color:#f92672>.</span><span style=color:#a6e22e>launch</span><span style=color:#f92672>(</span>Dispatchers<span style=color:#f92672>.</span><span style=color:#a6e22e>Main</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        val parser <span style=color:#f92672>=</span> Parser<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>        val articleList <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span><span style=color:#a6e22e>getArticles</span><span style=color:#f92672>(</span>url<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// The list contains all article&#39;s data. For example you can use it for your adapter.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>e<span style=color:#f92672>:</span> Exception<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Handle the exception
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>A complete example with Kotlin is available on <a href=https://github.com/prof18/RSS-Parser/tree/master/samplekotlin>Github</a>.</p><p>If you don’t know anything about the coroutines, I suggest you give a look to the <a href=https://codelabs.developers.google.com/codelabs/kotlin-coroutines/>Codelab</a> provided by Google.</p><p>Instead, if you are still using <strong>Java</strong> in your Android project, the usage is pretty the same as the older version of the library. You need to create a <em>Parser</em> object, implements the callbacks that handle the result and the error and finally start the parsing by calling the <em>execute</em> method passing the <em>URL</em> as parameter.</p><p>Here is an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> com.prof.rssparser.Article<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.prof.rssparser.OnTaskCompleted<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.prof.rssparser.Parser<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Parser parser <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Parser<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>parser<span style=color:#f92672>.</span><span style=color:#a6e22e>onFinish</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> OnTaskCompleted<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//what to do when the parsing is done
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>onTaskCompleted</span><span style=color:#f92672>(</span>List<span style=color:#f92672>&lt;</span>Article<span style=color:#f92672>&gt;</span> list<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// The list contains all article&#39;s data. For example you can use it for your adapter.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//what to do in case of error
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>onError</span><span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Handle the exception
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>parser<span style=color:#f92672>.</span><span style=color:#a6e22e>execute</span><span style=color:#f92672>(</span>urlString<span style=color:#f92672>);</span>
</span></span></code></pre></div><p>A complete example in Java is also available on <a href=https://github.com/prof18/RSS-Parser/tree/master/samplejava>Github</a>.</p><p>That’s all! For all the details or to report a bug, please visit the repo on <a href=https://github.com/prof18/RSS-Parser>Github</a>.</p></div><div class=article-footer><div class=post-content>To stay up to date with my writing and my projects, follow me on <a href=https://androiddev.social/@marcogom target=_blank>Mastodon</a> or <a href=https://twitter.com/marcoGomier target=_blank>Twitter</a>. If you have any questions, feel free to reach me out!</div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://www.marcogomiero.com>Marco Gomiero</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>