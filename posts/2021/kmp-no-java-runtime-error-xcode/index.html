<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>How to fix the "Unable to locate a Java Runtime" error on Xcode with Kotlin Multiplatform - Marco Gomiero</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A couple of days ago I opened my Kotlin Multiplatform pet project MoneyFlow on a different machine than usual. When I tried to run the app on the iOS simulator on Xcode, the build failed with a very strange error: &ldquo;The operation couldn&rsquo;t be completed. Unable to locate a Java Runtime&rdquo;.
This was a very strange issue because the JDK is installed and everything is working on the command line and Android Studio/IntelliJ."><meta property="og:image" content><meta name=google-site-verification content="7rDTNqn214SsZ9mmV8Ps5v2vqy8aXFWyoq08udChYCs"><meta property="og:title" content="How to fix the &#34;Unable to locate a Java Runtime&#34; error on Xcode with Kotlin Multiplatform"><meta property="og:description" content="A couple of days ago I opened my Kotlin Multiplatform pet project MoneyFlow on a different machine than usual. When I tried to run the app on the iOS simulator on Xcode, the build failed with a very strange error: &ldquo;The operation couldn&rsquo;t be completed. Unable to locate a Java Runtime&rdquo;.
This was a very strange issue because the JDK is installed and everything is working on the command line and Android Studio/IntelliJ."><meta property="og:type" content="article"><meta property="og:url" content="https://www.marcogomiero.com/posts/2021/kmp-no-java-runtime-error-xcode/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-27T00:00:00+00:00"><meta property="article:modified_time" content="2021-12-27T00:00:00+00:00"><meta property="og:site_name" content="Marco Gomiero"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to fix the &#34;Unable to locate a Java Runtime&#34; error on Xcode with Kotlin Multiplatform"><meta name=twitter:description content="A couple of days ago I opened my Kotlin Multiplatform pet project MoneyFlow on a different machine than usual. When I tried to run the app on the iOS simulator on Xcode, the build failed with a very strange error: &ldquo;The operation couldn&rsquo;t be completed. Unable to locate a Java Runtime&rdquo;.
This was a very strange issue because the JDK is installed and everything is working on the command line and Android Studio/IntelliJ."><script async src="https://www.googletagmanager.com/gtag/js?id=G-69FZ1TLE7E"></script>
<script>var doNotTrack=!1,dnt;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-69FZ1TLE7E")}</script><script src=https://www.marcogomiero.com/js/feather.min.js></script>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://www.marcogomiero.com/css/main.f2c7f60ec2d0155a784ade9b1b272143e1b8eb864a95bf75e606b49d8774389e.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://www.marcogomiero.com/css/dark.26c5bf79ef760a8f4feb8fc7be32ec86fc1f1da292b42c9fcc37879d4f774e3f.css disabled></head><body><div class=content><header><div class=main><a href=https://www.marcogomiero.com><h2>Marco Gomiero</h2></a></div><nav class=navbar><a href=/posts/><span>Write</span></a>
<a href=/talks/><span>Speak</span></a>
<a href=/projects/><span>Build</span></a>
<a href=/about-me/><span>About</span></a>
| <span class=dark-mode-toggle id=dark-mode-toggle onclick=toggleTheme()></span>
<script src=https://www.marcogomiero.com/js/themetoggle.js></script></nav></header><main><article><div class=title><h1 class=title>How to fix the "Unable to locate a Java Runtime" error on Xcode with Kotlin Multiplatform</h1><div class=post-meta><span title='2021-12-27 00:00:00 +0000 UTC'>27 December 2021</span></div></div><section class=body><span class=raw-html><div class=post-award-container><a href=https://androidweekly.net/issues/issue-499><img style=margin:0 src=https://androidweekly.net/issues/issue-499/badge></a></div></span><p>A couple of days ago I opened my Kotlin Multiplatform pet project <a href=https://github.com/prof18/MoneyFlow>MoneyFlow</a> on a different machine than usual. When I tried to run the app on the iOS simulator on Xcode, the build failed with a very strange error: &ldquo;The operation couldn&rsquo;t be completed. Unable to locate a Java Runtime&rdquo;.</p><figure><a href=/img/xcode-jvm-runtime/xcode-java-runtime.jpeg><img src=/img/xcode-jvm-runtime/xcode-java-runtime.jpeg></a></figure><p>This was a very strange issue because the JDK is installed and everything is working on the command line and Android Studio/IntelliJ.</p><p>After doing some research, I found out in <a href="https://youtrack.jetbrains.com/issue/KT-50474#focus=Comments-27-5673712.0-0">a comment of a Youtrack issue</a> that Xcode is taking the JDK version from <code>/usr/libexec/java_home</code>. So I tried to run <code>/usr/libexec/java_home</code> in the command line and I got the same error: <code>The operation couldn’t be completed. Unable to locate a Java Runtime.</code> Still strange.</p><p>I usually install the JDK manually with Homebrew, but for this time I decided to give <a href=https://sdkman.io/usage><code>sdkman</code></a> a try. And that was the problem because <code>sdkman</code> “doesn’t expose” the JDK version to <code>/usr/libexec/java_home</code>.</p><p>So I went back to the old and good manual way. Since the AdoptOpenJDK tap <a href=https://github.com/AdoptOpenJDK/homebrew-openjdk#-deprecation-notice->is deprecated</a>, I tried the <a href=https://formulae.brew.sh/cask/temurin>Temurin one</a> and installed Java 11 and Java 8.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew tap homebrew/cask-versions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>brew install --cask temurin8
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>brew install --cask temurin11
</span></span></code></pre></div><p>Then I adapted a couple of alias (to add on <code>.zshrc</code> or <code>.bash_profile</code> file) that I found out <a href=https://www.yippeecode.com/topics/upgrade-to-openjdk-temurin-using-homebrew/>in this article</a> to help me switch easily between Java 11 and Java 8, whenever I need.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ff5c57>export</span> <span style=color:#ff5c57>JAVA_11_HOME</span><span style=color:#ff6ac1>=</span>/Library/Java/JavaVirtualMachines/temurin-11.jdk/Contents/Home
</span></span><span style=display:flex><span><span style=color:#ff5c57>export</span> <span style=color:#ff5c57>JAVA_8_HOME</span><span style=color:#ff6ac1>=</span>/Library/Java/JavaVirtualMachines/temurin-8.jdk/Contents/Home
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>alias</span> <span style=color:#ff5c57>java11</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;export JAVA_HOME=</span><span style=color:#ff5c57>$JAVA_11_HOME</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>alias</span> <span style=color:#ff5c57>java8</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;export JAVA_HOME=</span><span style=color:#ff5c57>$JAVA_8_HOME</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#78787e># Set default to Java 11</span>
</span></span><span style=display:flex><span>java11
</span></span></code></pre></div><p>And with the manual installation, the build started working again!</p><hr><p>Another solution, suggested by <a href=https://twitter.com/martinbonnin>Martin Bonnin</a> is to explicitly set the <code>JAVA_HOME</code> inside the plist files under <code>~/Library/LaunchAgents/</code></p><blockquote class=twitter-tweet><p lang=en dir=ltr>Another solution is plist files under ~/Library/LaunchAgents/. There you can set the JAVA_HOME explicitely</p>&mdash; Martin Bonnin (@martinbonnin) <a href="https://twitter.com/martinbonnin/status/1474851964521525249?ref_src=twsrc%5Etfw">December 25, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></section><div class=article-footer><div class=body>To stay up to date with my writing and my projects, follow me on <a href=https://bsky.app/profile/marcogomiero.com target=_blank>Bluesky</a>, <a href=https://androiddev.social/@marcogom target=_blank>Mastodon</a> or <a href=https://twitter.com/marcoGomier target=_blank>Twitter</a>. If you have any questions, feel free to reach me out!</div></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.marcogomiero.com>Marco Gomiero</a></span></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-69FZ1TLE7E"></script>
<script>var doNotTrack=!1,dnt;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-69FZ1TLE7E")}</script></div></body></html>