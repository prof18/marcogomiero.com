<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Building an XCFramework on Kotlin Multiplatform from Kotlin 1.5.30 - Marco Gomiero</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A few days ago, Kotlin 1.5.30 has been released. One of the features contained in the release is the official support for XCFrameworks on Kotlin Multiplatform.
XCFramework is a binary that can contain multiple platform-specific variants (even for iOS and macOS at the same time). It has been introduced by Apple during the WWDC 2019 as a replacement for FatFrameworks.
Before Kotlin 1.5.30, an XCFramework could be created only by running the xcrun command that will pack the frameworks for every different required platform into an XCFramework."><meta property="og:image" content><meta property="og:title" content="Building an XCFramework on Kotlin Multiplatform from Kotlin 1.5.30"><meta property="og:description" content="A few days ago, Kotlin 1.5.30 has been released. One of the features contained in the release is the official support for XCFrameworks on Kotlin Multiplatform.
XCFramework is a binary that can contain multiple platform-specific variants (even for iOS and macOS at the same time). It has been introduced by Apple during the WWDC 2019 as a replacement for FatFrameworks.
Before Kotlin 1.5.30, an XCFramework could be created only by running the xcrun command that will pack the frameworks for every different required platform into an XCFramework."><meta property="og:type" content="article"><meta property="og:url" content="https://www.marcogomiero.com/posts/2021/kmp-xcframework-official-support/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-30T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-30T00:00:00+00:00"><meta property="og:site_name" content="Marco Gomiero"><meta name=twitter:card content="summary"><meta name=twitter:title content="Building an XCFramework on Kotlin Multiplatform from Kotlin 1.5.30"><meta name=twitter:description content="A few days ago, Kotlin 1.5.30 has been released. One of the features contained in the release is the official support for XCFrameworks on Kotlin Multiplatform.
XCFramework is a binary that can contain multiple platform-specific variants (even for iOS and macOS at the same time). It has been introduced by Apple during the WWDC 2019 as a replacement for FatFrameworks.
Before Kotlin 1.5.30, an XCFramework could be created only by running the xcrun command that will pack the frameworks for every different required platform into an XCFramework."><script src=https://www.marcogomiero.com/js/feather.min.js></script>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://www.marcogomiero.com/css/main.8fe5ace0a232e45b783ae12e0eef4deff9d16c430f2dddaa7c5e21f36da4cbba.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://www.marcogomiero.com/css/dark.2d1f13dc82ea2d94683809543a326af8a9a1f3a6c000f7b7af5d8f02a2e6ec25.css disabled></head><body><div class=content><header><div class=main><a href=https://www.marcogomiero.com><h2>Marco Gomiero</h2></a></div><nav class=navbar><a href=/posts/><span>Write</span></a>
<a href=/talks/><span>Speak</span></a>
<a href=/projects/><span>Build</span></a>
<a href=/about-me/><span>About</span></a>
| <span class=dark-mode-toggle id=dark-mode-toggle onclick=toggleTheme()></span>
<script src=https://www.marcogomiero.com/js/themetoggle.js></script></nav></header><main><article><div class=title><h1 class=title>Building an XCFramework on Kotlin Multiplatform from Kotlin 1.5.30</h1><div class=post-meta><span title='2021-08-30 00:00:00 +0000 UTC'>30 August 2021</span></div></div><section class=body><span class=raw-html><div class=post-award-container><a href=https://mailchi.mp/kotlinweekly/kotlin-weekly-266><img style=margin:0 src=https://img.shields.io/badge/Featured%20in%20kotlinweekly.net-Issue%20%23266-%237874b4></a></div></span><p>A few days ago, <a href=https://kotlinlang.org/docs/whatsnew1530.html>Kotlin 1.5.30 has been released</a>. One of the features contained in the release is the official support for XCFrameworks on Kotlin Multiplatform.</p><p><a href=https://help.apple.com/xcode/mac/11.4/#/dev544efab96>XCFramework</a> is a binary that can contain multiple platform-specific variants (even for iOS and macOS at the same time). It has been introduced by Apple during the <a href=https://developer.apple.com/videos/play/wwdc2019/416/>WWDC 2019</a> as a replacement for FatFrameworks.</p><p>Before Kotlin 1.5.30, an XCFramework could be created only by running the <code>xcrun</code> command that will pack the frameworks for every different required platform into an XCFramework.</p><p>A few weeks ago, I wrote <a href=https://www.marcogomiero.com/posts/2021/build-xcframework-kmp/>an article</a> to show how to create two Gradle tasks (<code>buildDebugXCFramework</code> and <code>buildReleaseXCFramework</code>) to automate the building of an XCFramework. With Kotlin 1.5.30 these tasks are not necessary anymore and in this article, I will show you how to replace the custom tasks with the official ones.</p><h2 id=build-an-xcframework-with-kotlin-1530>Build an XCFramework with Kotlin 1.5.30</h2><p>To start using XCFrameworks, it is necessary to create an XCFramework object inside the <code>kotlin</code> block of the <code>build.gradle.kts</code> file. Then, every Apple target should be added to that object.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#ff6ac1>import</span> org.jetbrains.kotlin.gradle.plugin.mpp.apple.XCFramework
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>val</span> libName = <span style=color:#ff5c57>“</span>LibraryName<span style=color:#ff5c57>”</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kotlin {
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>val</span> xcFramework = XCFramework(libName)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ios {
</span></span><span style=display:flex><span>        binaries.framework(libName) {
</span></span><span style=display:flex><span>            xcFramework.add(<span style=color:#ff6ac1>this</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>..</span>.
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>After declaring the XCFramework object, three new tasks are added:</p><ul><li>assemble${libName}XCFramework</li><li>assemble${libName}DebugXCFramework</li><li>assemble${libName}ReleaseXCFramework</li></ul><p>The first one will create both the release and the debug version of the XCFramework, while the others will create only the requested variant.</p><p>The XCFrameworks are located in the <code>XCFrameworks</code> folder inside the <code>build</code> folder. There will be a subfolder for each of the built variants.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── build
</span></span><span style=display:flex><span>    ├── XCFrameworks
</span></span><span style=display:flex><span>        ├── debug
</span></span><span style=display:flex><span>        │   └── LibraryName.xcframework
</span></span><span style=display:flex><span>        └── release
</span></span><span style=display:flex><span>            └── LibraryName.xcframework
</span></span></code></pre></div><h2 id=publish-an-xcframework>Publish an XCFramework</h2><p>The newly built XCFramework can now be distributed. The distribution can be archived in different ways: for example in a <em><a href=https://cocoapods.org/>CocoaPods</a></em> repository, in the <a href=https://swift.org/package-manager/>Swift Package Manager</a> or with <a href=https://github.com/Carthage/Carthage>Carthage</a>. Since I’m familiar with CocoaPods, that’s what I’ve always used.</p><p>To make the publishing process as streamlined as possible, I’ve written a bunch of Gradle tasks to automatically build and publish through git the Debug and Release version of the XCFramework. For the details and to understand how the task works, I suggest you give a look at <a href=https://www.marcogomiero.com/posts/2021/kmp-existing-project/>this article</a> that I wrote a few months ago.</p><p>These tasks are the same used in <a href=https://www.marcogomiero.com/posts/2021/build-xcframework-kmp/>the article</a> that I wrote a few weeks ago about XCFrameworks. But they must be updated, since the tasks to build the XCFramework are changed.</p><p><strong>Publish Debug Version</strong>:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>register(<span style=color:#5af78e>&#34;publishDevFramework&#34;</span>) {
</span></span><span style=display:flex><span>    description = <span style=color:#5af78e>&#34;Publish iOs framework to the Cocoa Repo&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    project.exec {
</span></span><span style=display:flex><span>        workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>        commandLine(<span style=color:#5af78e>&#34;git&#34;</span>, <span style=color:#5af78e>&#34;checkout&#34;</span>, <span style=color:#5af78e>&#34;develop&#34;</span>).standardOutput
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    dependsOn(<span style=color:#5af78e>&#34;assemble</span><span style=color:#5af78e>${libName}</span><span style=color:#5af78e>DebugXCFramework&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    doLast {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        copy {
</span></span><span style=display:flex><span>            from(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$buildDir</span><span style=color:#5af78e>/XCFrameworks/debug&#34;</span>)
</span></span><span style=display:flex><span>            into(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> dir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest/</span><span style=color:#5af78e>$libName</span><span style=color:#5af78e>.podspec&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> tempFile = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest/</span><span style=color:#5af78e>$libName</span><span style=color:#5af78e>.podspec.new&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> reader = dir.bufferedReader()
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> writer = tempFile.bufferedWriter()
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>var</span> currentLine: String?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>while</span> (reader.readLine().also { currLine <span style=color:#ff6ac1>-&gt;</span> currentLine = currLine } <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>null</span>) {
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>if</span> (currentLine<span style=color:#ff6ac1>?.</span>startsWith(<span style=color:#5af78e>&#34;s.version&#34;</span>) <span style=color:#ff6ac1>==</span> <span style=color:#ff6ac1>true</span>) {
</span></span><span style=display:flex><span>                writer.write(<span style=color:#5af78e>&#34;s.version       = </span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>${libVersionName}</span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>&#34;</span> + System.lineSeparator())
</span></span><span style=display:flex><span>            } <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span>                writer.write(currentLine + System.lineSeparator())
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        writer.close()
</span></span><span style=display:flex><span>        reader.close()
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> successful = tempFile.renameTo(dir)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> (successful) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            project.exec {
</span></span><span style=display:flex><span>                workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>                commandLine(
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;git&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;add&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;.&#34;</span>
</span></span><span style=display:flex><span>                ).standardOutput
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>val</span> dateFormatter = SimpleDateFormat(<span style=color:#5af78e>&#34;dd/MM/yyyy - HH:mm&#34;</span>, Locale.getDefault())
</span></span><span style=display:flex><span>            project.exec {
</span></span><span style=display:flex><span>                workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>                commandLine(
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;git&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;commit&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;-m&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;</span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>New dev release: </span><span style=color:#5af78e>${libVersionName}</span><span style=color:#5af78e>-</span><span style=color:#5af78e>${dateFormatter.format(Date())}</span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>                ).standardOutput
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            project.exec {
</span></span><span style=display:flex><span>                workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>                commandLine(<span style=color:#5af78e>&#34;git&#34;</span>, <span style=color:#5af78e>&#34;push&#34;</span>, <span style=color:#5af78e>&#34;origin&#34;</span>, <span style=color:#5af78e>&#34;develop&#34;</span>).standardOutput
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The task now depends on the <code>assemble${libName}DebugXCFramework</code> task, which is officially provided by Kotlin. Then, the only thing to do is to move the XCFramework from the <code>build</code> folder to the CocoaPod repository.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>copy {
</span></span><span style=display:flex><span>    from(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$buildDir</span><span style=color:#5af78e>/XCFrameworks/debug&#34;</span>)
</span></span><span style=display:flex><span>    into(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The task that publishes the release version of the XCFramework is pretty much the same as the debug one, except for the task to build the framework, that is <code>assemble${libName}ReleaseXCFramework</code>, and the location in the <code>build</code> folder:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>register(<span style=color:#5af78e>&#34;publishFramework&#34;</span>) {
</span></span><span style=display:flex><span>    description = <span style=color:#5af78e>&#34;Publish iOs framework to the Cocoa Repo&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    project.exec {
</span></span><span style=display:flex><span>        workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>        commandLine(<span style=color:#5af78e>&#34;git&#34;</span>, <span style=color:#5af78e>&#34;checkout&#34;</span>, <span style=color:#5af78e>&#34;master&#34;</span>).standardOutput
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e>// Create Release Framework for Xcode
</span></span></span><span style=display:flex><span><span style=color:#78787e></span>    dependsOn(<span style=color:#5af78e>&#34;assemble</span><span style=color:#5af78e>${libName}</span><span style=color:#5af78e>ReleaseXCFramework&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e>// Replace
</span></span></span><span style=display:flex><span><span style=color:#78787e></span>    doLast {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        copy {
</span></span><span style=display:flex><span>            from(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$buildDir</span><span style=color:#5af78e>/XCFrameworks/release&#34;</span>)
</span></span><span style=display:flex><span>            into(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> dir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest/</span><span style=color:#5af78e>$libName</span><span style=color:#5af78e>.podspec&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> tempFile = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest/</span><span style=color:#5af78e>$libName</span><span style=color:#5af78e>.podspec.new&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> reader = dir.bufferedReader()
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> writer = tempFile.bufferedWriter()
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>var</span> currentLine: String?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>while</span> (reader.readLine().also { currLine <span style=color:#ff6ac1>-&gt;</span> currentLine = currLine } <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>null</span>) {
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>if</span> (currentLine<span style=color:#ff6ac1>?.</span>startsWith(<span style=color:#5af78e>&#34;s.version&#34;</span>) <span style=color:#ff6ac1>==</span> <span style=color:#ff6ac1>true</span>) {
</span></span><span style=display:flex><span>                writer.write(<span style=color:#5af78e>&#34;s.version       = </span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>${libVersionName}</span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>&#34;</span> + System.lineSeparator())
</span></span><span style=display:flex><span>            } <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span>                writer.write(currentLine + System.lineSeparator())
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        writer.close()
</span></span><span style=display:flex><span>        reader.close()
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>val</span> successful = tempFile.renameTo(dir)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> (successful) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            project.exec {
</span></span><span style=display:flex><span>                workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>                commandLine(
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;git&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;add&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#5af78e>&#34;.&#34;</span>
</span></span><span style=display:flex><span>                ).standardOutput
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            project.exec {
</span></span><span style=display:flex><span>                workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>                commandLine(<span style=color:#5af78e>&#34;git&#34;</span>, <span style=color:#5af78e>&#34;commit&#34;</span>, <span style=color:#5af78e>&#34;-m&#34;</span>, <span style=color:#5af78e>&#34;</span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>New release: </span><span style=color:#5af78e>${libVersionName}</span><span style=color:#5af78e>\&#34;</span><span style=color:#5af78e>&#34;</span>).standardOutput
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            project.exec {
</span></span><span style=display:flex><span>                workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>                commandLine(<span style=color:#5af78e>&#34;git&#34;</span>, <span style=color:#5af78e>&#34;tag&#34;</span>, libVersionName).standardOutput
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            project.exec {
</span></span><span style=display:flex><span>                workingDir = File(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$rootDir</span><span style=color:#5af78e>/../kmp-xcframework-dest&#34;</span>)
</span></span><span style=display:flex><span>                commandLine(<span style=color:#5af78e>&#34;git&#34;</span>, <span style=color:#5af78e>&#34;push&#34;</span>, <span style=color:#5af78e>&#34;origin&#34;</span>, <span style=color:#5af78e>&#34;master&#34;</span>, <span style=color:#5af78e>&#34;--tags&#34;</span>).standardOutput
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And that’s it! With these little modifications, it is possible to use the official Kotlin support for XCFrameworks and automatically publish them in a CocoaPod repository.</p><p>On GitHub, I’ve updated the sample project with the new tasks on the <a href=https://github.com/prof18/kmp-xcframework-sample/tree/kotlin-1.5.30>kotlin-1.5.30 branch</a>. Instead, if you are interested in XCFramework support before Kotlin 1.5.30, you can look at the <a href=https://github.com/prof18/kmp-xcframework-sample/tree/pre-kotlin-1.5.30>pre-kotlin-1.5.30</a> branch. And to see what are the changes between the two branches, you can look <a href=https://github.com/prof18/kmp-xcframework-sample/commit/18fb4ec0fad6ec2b058a2a543c0c1de914c0a0c9#diff-c0dfa6bc7a8685217f70a860145fbdf416d449eaff052fa28352c5cec1a98c06>at this commit</a>.</p></section><div class=article-footer><div class=body>To stay up to date with my writing and my projects, follow me on <a href=https://androiddev.social/@marcogom target=_blank>Mastodon</a> or <a href=https://twitter.com/marcoGomier target=_blank>Twitter</a>. If you have any questions, feel free to reach me out!</div></div></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.marcogomiero.com>Marco Gomiero</a></span></footer><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-69FZ1TLE7E","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>