<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Don’t let Maven block you! - Marco Gomiero</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="As developers, we&rsquo;ve all encountered build failures in CI (or on our local machines) due to Maven repository issues preventing dependency downloads.
> Could not download foo-lib-1.0.aar (org.acme.foo:foo-lib:1.0) > Could not get resource 'https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar'. > Could not GET 'https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar'. Received status code 403 from server: There could be many reasons for this: the Maven repository is currently down or is having an incident, the repository has been shut down (hello, JCenter), and the dependency is old and not republished elsewhere."><meta property="og:image" content><meta name=google-site-verification content="7rDTNqn214SsZ9mmV8Ps5v2vqy8aXFWyoq08udChYCs"><meta property="og:title" content="Don’t let Maven block you!"><meta property="og:description" content="As developers, we&rsquo;ve all encountered build failures in CI (or on our local machines) due to Maven repository issues preventing dependency downloads.
> Could not download foo-lib-1.0.aar (org.acme.foo:foo-lib:1.0) > Could not get resource 'https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar'. > Could not GET 'https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar'. Received status code 403 from server: There could be many reasons for this: the Maven repository is currently down or is having an incident, the repository has been shut down (hello, JCenter), and the dependency is old and not republished elsewhere."><meta property="og:type" content="article"><meta property="og:url" content="https://www.marcogomiero.com/posts/2025/ublock-maven/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-05T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-05T00:00:00+00:00"><meta property="og:site_name" content="Marco Gomiero"><meta name=twitter:card content="summary"><meta name=twitter:title content="Don’t let Maven block you!"><meta name=twitter:description content="As developers, we&rsquo;ve all encountered build failures in CI (or on our local machines) due to Maven repository issues preventing dependency downloads.
> Could not download foo-lib-1.0.aar (org.acme.foo:foo-lib:1.0) > Could not get resource 'https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar'. > Could not GET 'https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar'. Received status code 403 from server: There could be many reasons for this: the Maven repository is currently down or is having an incident, the repository has been shut down (hello, JCenter), and the dependency is old and not republished elsewhere."><script async src="https://www.googletagmanager.com/gtag/js?id=G-69FZ1TLE7E"></script>
<script>var doNotTrack=!1,dnt;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-69FZ1TLE7E")}</script><script src=https://www.marcogomiero.com/js/feather.min.js></script>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://www.marcogomiero.com/css/main.f2c7f60ec2d0155a784ade9b1b272143e1b8eb864a95bf75e606b49d8774389e.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://www.marcogomiero.com/css/dark.26c5bf79ef760a8f4feb8fc7be32ec86fc1f1da292b42c9fcc37879d4f774e3f.css disabled></head><body><div class=content><header><div class=main><a href=https://www.marcogomiero.com><h2>Marco Gomiero</h2></a></div><nav class=navbar><a href=/posts/><span>Write</span></a>
<a href=/talks/><span>Speak</span></a>
<a href=/projects/><span>Build</span></a>
<a href=/about-me/><span>About</span></a>
| <span class=dark-mode-toggle id=dark-mode-toggle onclick=toggleTheme()></span>
<script src=https://www.marcogomiero.com/js/themetoggle.js></script></nav></header><main><article><div class=title><h1 class=title>Don’t let Maven block you!</h1><div class=post-meta><span title='2025-01-05 00:00:00 +0000 UTC'>5 January 2025</span></div></div><section class=body><p>As developers, we&rsquo;ve all encountered build failures in CI (or on our local machines) due to Maven repository issues preventing dependency downloads.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&gt; Could not download foo-lib-1.0.aar (org.acme.foo:foo-lib:1.0)
</span></span><span style=display:flex><span>   &gt; Could not get resource &#39;https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar&#39;.
</span></span><span style=display:flex><span>      &gt; Could not GET &#39;https://mavenrepo.com/org/acme/foo/foo-lib/1.0/foo-lib-1.0.aar&#39;. Received status code 403 from server: 
</span></span></code></pre></div><p>There could be many reasons for this: the Maven repository is currently down or is having an incident, the repository has been shut down (hello, JCenter), and the dependency is old and not republished elsewhere.</p><p>Usually, the dependencies are cached by Gradle, but the cache can expire.</p><p>If the cache is not on our side, there&rsquo;s another way instead of just waiting for the problem to be fixed: we can create a <code>Maven Local</code> repository for the failing dependency inside the project.</p><h2 id=create-a-project-specific-maven-local-repository>Create a project-specific Maven Local Repository</h2><p>A <code>Maven Local</code> repository is a simple directory on a local machine&rsquo;s home folder (<code>~/.m2</code> on macOS, for example) that stores the dependencies artifacts.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>.
</span></span><span style=display:flex><span>└── .m2
</span></span><span style=display:flex><span>    └── repository
</span></span><span style=display:flex><span>        ├── com
</span></span><span style=display:flex><span>        │   └── acme
</span></span><span style=display:flex><span>		│       └── ...        
</span></span><span style=display:flex><span>        └── org
</span></span><span style=display:flex><span>            └── company
</span></span><span style=display:flex><span> 		        └── ...            
</span></span></code></pre></div><p>Such a folder can be placed anywhere, even inside a project. This way, it&rsquo;s possible to create a <code>Maven local</code> repository for the <code>org.acme.foo:foo-lib</code> library that cannot be downloaded.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>~/my-project/.m2
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>└── .m2
</span></span><span style=display:flex><span>    └── repository
</span></span><span style=display:flex><span>        └── com
</span></span><span style=display:flex><span>            └── acme
</span></span><span style=display:flex><span>                └── foo
</span></span><span style=display:flex><span>                    └── foo-lib
</span></span><span style=display:flex><span>                        └── 1.0
</span></span><span style=display:flex><span>                            └── ...
</span></span></code></pre></div><p>However, the library&rsquo;s binary is needed. Otherwise, the repository is useless. The binary can be retrieved inside the Gradle cache, of course where it’s available. In my scenario, the CI failed because the cache expired, but my local environment was still working.</p><p>Gradle is caching the binaries of the dependencies in the <code>.gradle/caches/modules-2/files-2.1</code> folder. In the case of the<code>org.acme.foo:foo-lib</code> library, the binaries will be in the <code>.gradle/caches/modules-2/files-2.1/org.acme.foo</code> folder.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>.
</span></span><span style=display:flex><span>└── foo-lib
</span></span><span style=display:flex><span>    └── 1.0
</span></span><span style=display:flex><span>       ├── 296c9bacc53c3c2a8a328cd233b43156f0efb9bb
</span></span><span style=display:flex><span>       │   └── foo-lib-1.0.aar
</span></span><span style=display:flex><span>       └── 3095a593f57c0aff8e93596b12e4588fbfa3a7e3
</span></span><span style=display:flex><span>           └── foo-lib-1.0.pom
</span></span></code></pre></div><p>The <code>.aar</code> and the <code>.pom</code> files can now be moved to the local Maven repository that was created inside the project.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>~/my-project/.m2
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>└── .m2
</span></span><span style=display:flex><span>    └── repository
</span></span><span style=display:flex><span>        └── com
</span></span><span style=display:flex><span>            └── acme
</span></span><span style=display:flex><span>                └── foo
</span></span><span style=display:flex><span>                    └── foo-lib
</span></span><span style=display:flex><span>                        └── 1.0
</span></span><span style=display:flex><span>                            ├── foo-lib-1.0.aar
</span></span><span style=display:flex><span>                            └── foo-lib-1.0.pom
</span></span></code></pre></div><p>As the last step, Gradle needs to know that he must grab only the library from the local Maven repository, not from the Internet. To do so, repositories settings in the <code>settings.gradle.kts</code> file need to be modified.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>dependencyResolutionManagement {  
</span></span><span style=display:flex><span>    repositoriesMode.<span style=color:#ff6ac1>set</span>(RepositoriesMode.FAIL_ON_PROJECT_REPOS)  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    repositories {  
</span></span><span style=display:flex><span>        mavenCentral()  
</span></span><span style=display:flex><span>        google()  
</span></span><span style=display:flex><span>        <span style=color:#78787e>// Define local Maven repository for specific dependencies
</span></span></span><span style=display:flex><span><span style=color:#78787e></span>        maven {
</span></span><span style=display:flex><span>	        <span style=color:#78787e>// Point to the project-specific Maven repository  
</span></span></span><span style=display:flex><span><span style=color:#78787e></span>            url = uri(<span style=color:#5af78e>&#34;file://</span><span style=color:#5af78e>${rootProject.projectDir}</span><span style=color:#5af78e>/.m2/repository&#34;</span>)  
</span></span><span style=display:flex><span>            content {
</span></span><span style=display:flex><span>                <span style=color:#78787e>// Only use this repository for the specified dependency  
</span></span></span><span style=display:flex><span><span style=color:#78787e></span>                includeModule(<span style=color:#5af78e>&#34;org.acme.foo&#34;</span>, <span style=color:#5af78e>&#34;foo-lib&#34;</span>)  
</span></span><span style=display:flex><span>            }  
</span></span><span style=display:flex><span>        }    
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And voilà! The project can still be built with the local version of the missing dependency until it becomes available again.</p></section><div class=article-footer><div class=body>To stay up to date with my writing and my projects, follow me on <a href=https://bsky.app/profile/marcogomiero.com target=_blank>Bluesky</a>, <a href=https://androiddev.social/@marcogom target=_blank>Mastodon</a> or <a href=https://twitter.com/marcoGomier target=_blank>Twitter</a>. If you have any questions, feel free to reach me out!</div></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.marcogomiero.com>Marco Gomiero</a></span></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-69FZ1TLE7E"></script>
<script>var doNotTrack=!1,dnt;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-69FZ1TLE7E")}</script></div></body></html>